# ุฑุงูููุง ุชุณุช ุฏุฑฺฏุงู ุจุงูฺฉ ุณุงูุงู (SEP)

ุงู ูพุฑูฺู ุจุฑุง ุชุณุช ุชุบุฑุงุช ุงุนูุงู ุดุฏู ุฑู ุฏุฑฺฏุงู ุจุงูฺฉ ุณุงูุงู ุงุฌุงุฏ ุดุฏู ุงุณุช.

## ๐ ูพุดโูุงุฒูุง

1. Python 3.8 ุง ุจุงูุงุชุฑ
2. Django 3.0 ุง ุจุงูุงุชุฑ
3. ฺฉุฏ ูพุฐุฑูุฏู ู ุชุฑููุงู ุจุงูฺฉ ุณุงูุงู

## ๐ ุฑุงูโุงูุฏุงุฒ

### 1. ูุตุจ ูุงุจุณุชฺฏโูุง

```bash
cd test_project
pip install -r requirements.txt
```

ุง ุงฺฏุฑ ุงุฒ ูุญุท ูุฌุงุฒ ุงุณุชูุงุฏู ูโฺฉูุฏ:

```bash
cd test_project
python -m venv venv
source venv/bin/activate  # ุฏุฑ Windows: venv\Scripts\activate
pip install -r requirements.txt
```

### 2. ุชูุธูุงุช

ูุงู `sep_test/settings.py` ุฑุง ุจุงุฒ ฺฉูุฏ ู ุงุทูุงุนุงุช ุฏุฑฺฏุงู ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ:

```python
AZ_IRANIAN_BANK_GATEWAYS = {
    "GATEWAYS": {
        "SEP": {
            "MERCHANT_CODE": "YOUR_MERCHANT_CODE",  # ฺฉุฏ ูพุฐุฑูุฏู ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ
            "TERMINAL_CODE": "YOUR_TERMINAL_CODE",  # ฺฉุฏ ุชุฑููุงู ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ
        },
    },
    # ...
}
```

### 3. ุชูุธู ุฏุงููู ุณุงุช

ุฏุฑ ูพูู ุงุฏูู Django:
1. ุจู ุขุฏุฑุณ `http://127.0.0.1:8000/admin/` ุจุฑูุฏ
2. ูุงุฑุฏ ุจุฎุด **Sites** ุดูุฏ
3. ุณุงุช ุจุง ID=1 ุฑุง ูุฑุงุด ฺฉูุฏ
4. **Domain name** ุฑุง ุจู ุฏุงููู ุฎูุฏ ุชุบุฑ ุฏูุฏ (ูุซูุงู `example.com`)

**ูฺฉุชู ููู:** ุงฺฏุฑ ุงุฒ localhost ุงุณุชูุงุฏู ูโฺฉูุฏุ ูโุชูุงูุฏ `localhost` ุง `127.0.0.1` ุฑุง ูุงุฑุฏ ฺฉูุฏ.

### 4. ุงุฌุฑุง Migration

```bash
python manage.py migrate
```

### 5. ุงุฌุฑุง ุณุฑูุฑ

```bash
python manage.py runserver
```

## ๐งช ุชุณุช

### ูุฑุงุญู ุชุณุช:

1. **ุจุงุฒ ฺฉุฑุฏู ุตูุญู ุงุตู:**
   ```
   http://127.0.0.1:8000/
   ```

2. **ุฑูุชู ุจู ุตูุญู ูพุฑุฏุงุฎุช:**
   - ุฑู ุฏฺฉูู "ุดุฑูุน ุชุณุช ูพุฑุฏุงุฎุช" ฺฉูฺฉ ฺฉูุฏ
   - ุง ูุณุชููุงู ุจู ุขุฏุฑุณ ุฒุฑ ุจุฑูุฏ:
   ```
   http://127.0.0.1:8000/payment/
   ```

3. **ูุงุฑุฏ ฺฉุฑุฏู ุงุทูุงุนุงุช:**
   - ูุจูุบ ุฑุง ูุงุฑุฏ ฺฉูุฏ (ุญุฏุงูู 1000 ุฑุงู)
   - ุดูุงุฑู ููุจุงู ุฑุง ูุงุฑุฏ ฺฉูุฏ (ุงุฎุชุงุฑ)

4. **ุงุฑุณุงู ุจู ุฏุฑฺฏุงู:**
   - ุฑู ุฏฺฉูู "ุงุฑุณุงู ุจู ุฏุฑฺฏุงู ุจุงูฺฉ ุณุงูุงู" ฺฉูฺฉ ฺฉูุฏ
   - ุจุงุฏ ุจู ุตูุญู ุฏุฑฺฏุงู ุจุงูฺฉ ุณุงูุงู ูุฏุงุช ุดูุฏ

5. **ุจุฑุฑุณ ูุชุฌู:**
   - ูพุณ ุงุฒ ูพุฑุฏุงุฎุช (ุง ูุบู)ุ ุจู ุตูุญู ูุชุฌู ูุฏุงุช ูโุดูุฏ
   - ุงุทูุงุนุงุช ุชุฑุงฺฉูุด ุฑุง ุจุฑุฑุณ ฺฉูุฏ

## ๐ ุจุฑุฑุณ ุชุบุฑุงุช

ุชุบุฑุงุช ุงุนูุงู ุดุฏู ุฏุฑ ูุงู `azbankgateways/banks/sep.py`:

1. โ ุชุบุฑ URL ุงุฒ `MobilePG/MobilePayment` ุจู `onlinepg/onlinepg`
2. โ ุงุณุชูุงุฏู ุงุฒ `terminal_code` ุจู ุฌุง `merchant_code` ุจุฑุง `TerminalId`
3. โ ุชุบุฑ ูุฑูุช ุงุฑุณุงู ุงุฒ JSON ุจู form-data
4. โ ุงุตูุงุญ ูุชุฏ verify ุจุฑุง ุงุณุชูุงุฏู ุงุฒ `terminal_code`

## โ๏ธ ูฺฉุงุช ููู

1. **SECURE_REFERRER_POLICY:** ุงู ุชูุธู ุฏุฑ `settings.py` ุจุงุฏ ุจู ุตูุฑุช ุฒุฑ ุจุงุดุฏ:
   ```python
   SECURE_REFERRER_POLICY = "strict-origin-when-cross-origin"
   ```

2. **ุฏุงููู:** ุฏุงูููโุง ฺฉู ุฏุฑ ุชูุธูุงุช ุชุฑููุงู ุจุงูฺฉ ุณุงูุงู ุซุจุช ุดุฏู ุจุงุฏ ุจุง ุฏุงูููโุง ฺฉู ุฏุฑ Django Sites ุชูุธู ฺฉุฑุฏูโุงุฏ ฺฉุณุงู ุจุงุดุฏ.

3. **IP Address:** ุงฺฏุฑ ุงุฒ ุณุฑูุฑ ุงุณุชูุงุฏู ูโฺฉูุฏุ IP ุณุฑูุฑ ุจุงุฏ ุฏุฑ ูุณุช IP ูุง ูุฌุงุฒ ุจุงูฺฉ ุณุงูุงู ุจุงุดุฏ.

4. **HTTPS:** ุฏุฑ ูุญุท production ุญุชูุงู ุงุฒ HTTPS ุงุณุชูุงุฏู ฺฉูุฏ.

## ๐ ุนุจโุงุจ

### ุฎุทุง: "ุชุฑููุงู ุจู ุงู ูุณุฎู ุงุฒ ุฏุฑฺฏุงู ุฏุณุชุฑุณ ูุฏุงุฑุฏ"
- โ ุงู ุฎุทุง ุจุงุฏ ุจุง ุชุบุฑุงุช ุงุนูุงู ุดุฏู ุจุฑุทุฑู ุดุฏู ุจุงุดุฏ
- ุงฺฏุฑ ูููุฒ ุงู ุฎุทุง ุฑุง ูโุจูุฏุ ุจุฑุฑุณ ฺฉูุฏ ฺฉู URL ุฏุฑุณุช ุชุบุฑ ฺฉุฑุฏู ุจุงุดุฏ

### ุฎุทุง: "ุขุฏุฑุณ ุงุฑุฌุงุนุฏููุฏู ูุนุชุจุฑ ูุณุช"
- ุฏุงููู ุฏุฑ Django Sites ุฑุง ุจุฑุฑุณ ฺฉูุฏ
- ุฏุงููู ุจุงุฏ ุจุง ุฏุงููู ุซุจุช ุดุฏู ุฏุฑ ุจุงูฺฉ ุณุงูุงู ฺฉุณุงู ุจุงุดุฏ

### ุฎุทุง: "ุขุฏุฑุณ ุณุฑูุฑ ูพุฐุฑูุฏู ูุนุชุจุฑ ููโุจุงุดุฏ"
- IP ุณุฑูุฑ ุฑุง ุจุฑุฑุณ ฺฉูุฏ
- IP ุจุงุฏ ุฏุฑ ูุณุช IP ูุง ูุฌุงุฒ ุจุงูฺฉ ุณุงูุงู ุจุงุดุฏ

## ๐ ูพุดุชุจุงู

ุฏุฑ ุตูุฑุช ุจุฑูุฒ ูุดฺฉู:
1. ูุงฺฏโูุง Django ุฑุง ุจุฑุฑุณ ฺฉูุฏ
2. Issue #158 ุฑุง ุฏุฑ GitHub ุจุฑุฑุณ ฺฉูุฏ
3. ุจุง ูพุดุชุจุงู ุจุงูฺฉ ุณุงูุงู ุชูุงุณ ุจฺฏุฑุฏ: epav@sep.ir

## ๐ ูุงฺฏโูุง

ุจุฑุง ูุดุงูุฏู ูุงฺฏโูุง ุฏููโุชุฑุ ูโุชูุงูุฏ ุณุทุญ ูุงฺฏ ุฑุง ุฏุฑ `settings.py` ุชุบุฑ ุฏูุฏ:

```python
LOGGING = {
    'version': 1,
    'disable_existing_loggers': False,
    'handlers': {
        'console': {
            'class': 'logging.StreamHandler',
        },
    },
    'root': {
        'handlers': ['console'],
        'level': 'DEBUG',
    },
}
```


